¬°Bienvenido al segundo video del **Curso Avanzado de n8n**! üõ†Ô∏è Este m√≥dulo te introduce a nodos y herramientas t√©cnicas esenciales para manipular datos, extender la funcionalidad con c√≥digo personalizado y comunicarte con cualquier API.

Aqu√≠ tienes un resumen detallado de **"n8n Curso Avanzado (2/8) - Nodos t√©cnicos avanzados"**:

***

## 1. Expresiones Avanzadas y Librer√≠as Integradas

Las expresiones (`{{ }}`) no solo sirven para acceder a datos, sino tambi√©n para transformar la informaci√≥n utilizando funciones integradas de n8n y librer√≠as externas.

### Funciones de Transformaci√≥n Nativas [[01:14](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=74)]
Puedes usar funciones de **JavaScript** b√°sicas (aritm√©tica) o funciones de **n8n** dise√±adas para manipular datos dentro de las llaves, lo que simplifica la l√≥gica compleja.

| Funci√≥n de Ejemplo | Uso |
| :--- | :--- |
| `{{ $json.nombreDeCampo }}` | Expresi√≥n b√°sica para acceder al valor de un campo [[00:28](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=28)]. |
| `{{ $json.invitationsSent - $json.acceptedInvitations }}` | Aritm√©tica b√°sica (resta) [[00:58](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=58)]. |
| `{{ $fn.extractDomain('user@acme.com') }}` | Funci√≥n de n8n para extraer el dominio de una cadena [[01:29](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=89)]. |
| `{{ $fn.isEmpty($json.data) }}` | Comprueba si un objeto (JSON) est√° vac√≠o [[01:54](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=114)]. |
| `{{ $fn.hasField($json, 'email') }}` | Comprueba si el *Item* tiene un campo espec√≠fico [[02:11](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=131)]. |

### Manejo de Fechas y Tiempo (Loxon) [[02:38](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=158)]
n8n utiliza la librer√≠a **Loxon** para facilitar el trabajo con objetos de fecha y hora dentro de las expresiones:

* **`{{ $now }}`:** Devuelve el objeto de fecha y hora actual (en formato *date object*).
* **Transformaci√≥n:** Los *date objects* deben convertirse de `string` a *date object* si se obtienen de la salida de un nodo, para poder realizar transformaciones (ej. sumar d√≠as o cambiar el formato).
* **Ejemplo:** `{{ $now.toFormat('yyyy-MM-dd') }}` para obtener la fecha de hoy con un formato espec√≠fico.

***

## 2. El Nodo Code (C√≥digo) üë®‚Äçüíª

El nodo **Code** (`C√≥digo`) te permite extender la flexibilidad de n8n m√°s all√° de sus nodos nativos, ejecutando *scripts* personalizados en **JavaScript** o **Python** [[04:05](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=245)].

### Comportamiento del C√≥digo [[04:32](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=272)]
* **Salida (Output):** El c√≥digo **debe retornar un *Array* (lista) de objetos JSON** si se ejecuta una sola vez para todos los *Items*, o un **objeto JSON singular** si se ejecuta para cada *Item*. Si no se retorna nada, el nodo fallar√°.
* **Variables de Entrada:**
    * `$input.all`: Retorna todos los *Items* de entrada del nodo [[05:32](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=332)].
    * `$json`: Permite acceder al *Item* JSON actual (similar a las expresiones).

### Modos de Ejecuci√≥n [[06:08](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=368)]
El modo elegido depende de la tarea:

| Modo | Ejecuci√≥n | Lo que debe retornar | Casos de Uso |
| :--- | :--- | :--- | :--- |
| **Run Once for All Items** | El *script* se ejecuta una sola vez para todos los *Items* de entrada. | Un **Array de objetos JSON** (ej. `[{...}, {...}]`) [[06:12](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=372)]. | C√°lculos que requieren la totalidad de los datos (sumas, promedios, deduplicaci√≥n). |
| **Run Once for Each Item** | El *script* se ejecuta individualmente por cada *Item* de entrada. | Un **objeto JSON singular** (ej. `{...}`) [[06:26](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=386)]. | Transformaciones espec√≠ficas por *Item* (ej. calcular el valor de orden promedio por cliente) [[13:15](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=795)]. |

***

## 3. El Nodo HTTP Request (Petici√≥n HTTP) üåê

El nodo **HTTP Request** (`Petici√≥n HTTP`) es esencialmente una herramienta de API como **Postman** dentro de n8n, permiti√©ndote interactuar con cualquier servicio web que no tenga un nodo dedicado [[07:06](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=426)].

### Caracter√≠sticas Avanzadas

* **Configuraci√≥n Completa:** Permite definir todos los aspectos de la petici√≥n (m√©todo, URL, *Headers*, cuerpo/body y par√°metros de consulta/query) [[07:22](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=442)].
* **Manejo de Paginaci√≥n:** En los ajustes avanzados, puedes configurar el nodo para manejar autom√°ticamente APIs que requieren m√∫ltiples llamadas para obtener todos los datos. El nodo puede buscar la URL o el *token* de la siguiente p√°gina en la respuesta de la API y continuar la petici√≥n de forma aut√≥noma, sin necesidad de crear un *loop* manual [[07:44](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=464)].
* **Uso de Credenciales:** Puedes seleccionar una credencial ya definida en n8n, y el nodo se encarga autom√°ticamente de la autenticaci√≥n (ej. a√±adir la API Key a los *Headers*), simplificando la integraci√≥n [[08:08](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=488)].

### Importar cURL [[08:44](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=524)]
Una funci√≥n clave de ahorro de tiempo es la opci√≥n **"Import cURL"**. Si la documentaci√≥n de una API proporciona un ejemplo de la petici√≥n en formato cURL, puedes pegarlo directamente en el nodo HTTP Request, y este **se autoconfigura** con la URL, el m√©todo, los *headers* y el cuerpo de la petici√≥n [[08:51](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=531)]. Esto elimina la tediosa tarea de configurar manualmente todos los campos.

***

El pr√≥ximo video te introducir√° a t√©cnicas de depuraci√≥n avanzadas, como fijar datos (*pinning*) y la edici√≥n manual de salidas [[16:32](http://www.youtube.com/watch?v=JM4jqYs4Fxo&t=992)].
http://googleusercontent.com/youtube_content/20
